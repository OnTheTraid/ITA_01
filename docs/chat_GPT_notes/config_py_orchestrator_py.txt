1. –ß—Ç–æ –¥–µ–ª–∞—é—Ç config.py –∏ orchestrator.py
config.py ‚Äî ‚Äú—Ü–µ–Ω—Ç—Ä –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø—Ä–æ–µ–∫—Ç–∞‚Äù

–≠—Ç–æ—Ç —Ñ–∞–π–ª ‚Äî –∫–∞–∫ –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤—Å–µ–º –ø—Ä–æ–µ–∫—Ç–æ–º.
–û–Ω –Ω–µ –∏—Å–ø–æ–ª–Ω—è–µ—Ç –ª–æ–≥–∏–∫—É, –Ω–æ –∑–∞–¥–∞—ë—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ –ø—É—Ç–∏, —á—Ç–æ–±—ã –≤—Å–µ —Å–∫—Ä–∏–ø—Ç—ã ‚Äú–≥–æ–≤–æ—Ä–∏–ª–∏ –Ω–∞ –æ–¥–Ω–æ–º —è–∑—ã–∫–µ‚Äù.

–ß—Ç–æ –æ–±—ã—á–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ config.py:

–ü—É—Ç–∏:

DATA_PATH = "D:/ITA/ITA_1.0/data/"
CACHE_PATH = "D:/ITA/ITA_1.0/cache/"


–¢–æ–∫–µ–Ω—ã –∏ API –∫–ª—é—á–∏ (–±–µ—Ä—É—Ç—Å—è –∏–∑ .env):

OPENAI_API_KEY = os.getenv("OPENAI_API_KEY")
NOTION_TOKEN = os.getenv("NOTION_TOKEN")


–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö –∏ –≤–µ–∫—Ç–æ—Ä–Ω–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞:

CHROMA_DB_PATH = "D:/ITA/ITA_1.0/chroma_db/"


–ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∞–≥–µ–Ω—Ç–∞:

DEFAULT_TIMEFRAME = "H1"
LIVE_TRADING_MODE = True


üìò –í –∏—Ç–æ–≥–µ ‚Äî –ª—é–±–æ–π –º–æ–¥—É–ª—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, backtester.py –∏–ª–∏ notion_uploader.py) –ø—Ä–æ—Å—Ç–æ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –Ω—É–∂–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

from config import DATA_PATH, OPENAI_API_KEY


–≠—Ç–æ —É–ø—Ä–æ—â–∞–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫—É ‚Äî –º–µ–Ω—è–µ—à—å –ø—É—Ç—å –∏–ª–∏ –∫–ª—é—á –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ, –∏ –≤—Å—ë –ø—Ä–æ–µ–∫—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –Ω–æ–≤—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏.

orchestrator.py ‚Äî ‚Äú–¥–∏—Ä–∏–∂—ë—Ä —Å–∏—Å—Ç–µ–º—ã‚Äù

–≠—Ç–æ—Ç —Ñ–∞–π–ª —É–ø—Ä–∞–≤–ª—è–µ—Ç –≤—ã–∑–æ–≤–∞–º–∏ –∏ –ø–æ—Ä—è–¥–∫–æ–º –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è —Ñ–ª–æ—É.
–ï—Å–ª–∏ config.py ‚Äî –º–æ–∑–≥ —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏, —Ç–æ orchestrator.py ‚Äî —ç—Ç–æ –Ω–µ—Ä–≤–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞, –∑–∞–ø—É—Å–∫–∞—é—â–∞—è –≤—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –ø–æ —Ü–µ–ø–æ—á–∫–µ.

–í –Ω—ë–º —Ç—ã:

–ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—à—å –≤—Å–µ –ø–æ–¥–º–æ–¥—É–ª–∏:

from flows.backtest_flow import backtest_flow
from flows.live_flow import live_flow


–û–ø—Ä–µ–¥–µ–ª—è–µ—à—å –ª–æ–≥–∏—á–µ—Å–∫—É—é —Å–≤—è–∑—å:

def run_full_pipeline(mode="backtest"):
    if mode == "backtest":
        result = backtest_flow()
    elif mode == "live":
        result = live_flow()
    else:
        raise ValueError("Unknown mode")
    return result


–ß–µ—Ä–µ–∑ Prefect Flow –æ–ø–∏—Å—ã–≤–∞–µ—à—å DAG ‚Äî –∫–∞–∫–∞—è –∑–∞–¥–∞—á–∞ –∏–¥—ë—Ç –∑–∞ –∫–∞–∫–æ–π:

from prefect import flow, task

@flow(name="Full Trading Agent Flow")
def orchestrate():
    data = load_data()
    features = process_data(data)
    signals = setup_manager(features)
    backtest = run_backtest(signals)
    report = export_to_notion(backtest)
    return report


–ü–æ–∑–∂–µ –º–æ–∂–µ—à—å –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å scheduler (scheduler.py), —á—Ç–æ–±—ã –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—É—Å–∫:

from prefect.deployments import Deployment
from prefect.server.schemas.schedules import CronSchedule

Deployment.build_from_flow(
    flow=orchestrate,
    name="daily_run",
    schedule=CronSchedule(cron="0 8 * * *")
)


üìò –ò—Ç–æ–≥:

config.py ‚Üí –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

orchestrator.py ‚Üí —Ü–µ–ø–æ—á–∫–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è –ª–æ–≥–∏–∫–∏ –∞–≥–µ–Ω—Ç–∞

scheduler.py ‚Üí —Ä–µ–≥—É–ª—è—Ä–Ω—ã–π –∑–∞–ø—É—Å–∫ —ç—Ç–∏—Ö —Ü–µ–ø–æ—á–µ–∫