# ???? ? ???????????? ?????????
$envPath = "D:\ITA\ITA_01"
$pythonPath = Join-Path $envPath "Scripts\python.exe"
$vscodeSettingsDir = "D:\ITA\.vscode"
$vscodeSettingsFile = Join-Path $vscodeSettingsDir "settings.json"

# ?????????, ?????????? ?? ?????????
if (-Not (Test-Path $pythonPath)) {
    Write-Host "? ?? ?????? ???? python.exe ?? ????: $pythonPath"
    Write-Host "?????? ????????? ????????: python -m venv D:\ITA\ITA_01"
    exit
}

# ??????? ????? .vscode, ???? ?? ???
if (-Not (Test-Path $vscodeSettingsDir)) {
    New-Item -ItemType Directory -Force -Path $vscodeSettingsDir | Out-Null
}

# ????????? ?????????? ????????
$settings = @{
    "python.defaultInterpreterPath" = $pythonPath
    "terminal.integrated.shellArgs.windows" = @("-ExecutionPolicy", "Bypass")
}

# ????????? JSON
$settings | ConvertTo-Json -Depth 4 | Out-File -Encoding UTF8 $vscodeSettingsFile -Force

Write-Host "? ????????? VS Code ?????????!"
Write-Host "?????? VS Code ????? ???????????? ?????????:"
Write-Host $pythonPath
Write-Host ""
Write-Host "?? ??????????? VS Code, ????? ????????? ???????? ? ????."
