# --- ?????????????? ????????? ????????? ITA_01 ??? ??????? VS Code ---

# ???? ? ??????? ? ?????????
$projectDir = "D:\ITA"
$venvPath = "D:\ITA\ITA_01\Scripts\Activate.ps1"

# ????????????? ??????? VS Code, ???? ???? ???????????
$codePath = (Get-Command code -ErrorAction SilentlyContinue)?.Source
if (-not $codePath) {
    $codePath = "C:\Users\user\AppData\Local\Programs\Microsoft VS Code\Code.exe"
}

# ????????? ?????????
if (-Not (Test-Path $venvPath)) {
    Write-Host "? ?? ??????? ????????? ITA_01. ?????? ??? ????????:"
    Write-Host "python -m venv D:\ITA\ITA_01"
    exit
}

# ?????????? ?????????
Write-Host "?? ?????????? ??????????? ????????? ITA_01..."
& $venvPath

# ????????? VS Code ? ???? ??????????
Write-Host "?? ????????? VS Code ? ???????: $projectDir"
Start-Process $codePath -ArgumentList $projectDir

Write-Host "? VS Code ??????? ? ???????? ?????????? ITA_01!"
