02.2.2_CSV_Archive_Loader
–ï—Å–ª–∏ –¥–∏–∞–ø–∞–∑–æ–Ω –∑–∞–ø—Ä–æ—à–µ–Ω–Ω—ã—Ö –¥–∞—Ç —á–∞—Å—Ç–∏—á–Ω–æ –ø–æ–∫—Ä—ã—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –∞—Ä—Ö–∏–≤–æ–º,
archive_loader –≤—ã—á–∏—Å–ª—è–µ—Ç –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ —É—á–∞—Å—Ç–∫–∏ –∏ –≤—ã–∑—ã–≤–∞–µ—Ç MT5Connector.run_mt5_ingest()
—Ç–æ–ª—å–∫–æ –¥–ª—è —ç—Ç–∏—Ö –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤. –ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è merge –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∞—Ä—Ö–∏–≤–∞.

üìê –ê–ª–≥–æ—Ä–∏—Ç–º –º–æ–∂–Ω–æ –æ–ø–∏—Å–∞—Ç—å —Ç–∞–∫:

if requested_range ‚äÇ existing_range:
    return archive
elif requested_range ‚à© existing_range ‚â† ‚àÖ:
    load missing part from MT5Connector
    merge and resave archive
else:
    full fetch from MT5Connector

üîπ –ü–æ–≤–µ–¥–µ–Ω–∏–µ
–°—Ü–µ–Ω–∞—Ä–∏–π	–î–µ–π—Å—Ç–≤–∏–µ	–†–µ–∑—É–ª—å—Ç–∞—Ç
–ê—Ä—Ö–∏–≤ –Ω–∞–π–¥–µ–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é	–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç status="ARCHIVED"	–≠–∫–æ–Ω–æ–º–∏—Ç —Ä–µ—Å—É—Ä—Å—ã
–ê—Ä—Ö–∏–≤ –Ω–∞–π–¥–µ–Ω —á–∞—Å—Ç–∏—á–Ω–æ	–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–π –¥–∏–∞–ø–∞–∑–æ–Ω –≤ MT5Connector	–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –¥–æ–∑–∞–≥—Ä—É–∑–∫–∞
–ê—Ä—Ö–∏–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω	–ó–∞–ø—É—Å–∫ MT5Connector	–°–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—ã–π .parquet
–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏	–í–æ–∑–≤—Ä–∞—Ç status="FAILED"	–õ–æ–≥ –≤ logs/coredata

üîπ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø–∞–π–ø–ª–∞–π–Ω–æ–º Prefect Flow
–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤ –≤ Prefect Dashboard:

üü¢ –ê—Ä—Ö–∏–≤ –Ω–∞–π–¥–µ–Ω

üü† –î–æ–∑–∞–≥—Ä—É–∑–∫–∞

üîµ –ó–∞–≥—Ä—É–∑–∫–∞ —Å MT5

üî¥ –û—à–∏–±–∫–∞

–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –º–æ–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤ —Ç–∞—Å–∫–µ Prefect:

@task(name="ArchiveLoaderTask", log_prints=True)
def load_or_request_data(ctx):
    ...
    prefect.context.get_run_logger().info("[ARCHIVE] –î–∞–Ω–Ω—ã–µ –Ω–∞–π–¥–µ–Ω—ã ‚Äî ARCHIVED")


–≠—Ç–æ –¥–∞—Å—Ç –Ω–∞–º –∫—Ä–∞—Å–∏–≤—ã–µ —Å—Ç–∞—Ç—É—Å—ã –≤ Prefect UI –±–µ–∑ –æ—Ç–¥–µ–ª—å–Ω–æ–π –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–π –æ–±–æ–ª–æ—á–∫–∏.